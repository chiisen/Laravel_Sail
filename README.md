# Laravel_Sail
å­¸ç¿’ Laravel Sail çš„å°ˆæ¡ˆã€‚

## ğŸ³ Laravel Sail æ˜¯ä»€éº¼ï¼Ÿ

ç°¡å–®ä¾†èªªï¼Œ**Laravel Sail** å°±æ˜¯ä¸€å€‹è®“ä½ **ä¸ç”¨ç…©æƒ±ç’°å¢ƒè¨­å®š**å°±èƒ½é¦¬ä¸Šé–‹å§‹å¯«ç¨‹å¼çš„è¶…ç´šå¥½å¹«æ‰‹ï¼âœ¨

å®ƒå¹«ä½ æŠŠé–‹ç™¼ç¶²ç«™éœ€è¦çš„æ‰€æœ‰å·¥å…·ï¼ˆåƒæ˜¯ PHPã€MySQL è³‡æ–™åº«ã€Redis...ç­‰ï¼‰éƒ½æ‰“åŒ…åœ¨ä¸€å€‹å«åš **Docker** çš„å®¹å™¨ç›’å­è£¡ã€‚

**ç‚ºä»€éº¼è¦ç”¨å®ƒï¼Ÿ**

*   ğŸš€ **æ¥µé€Ÿå•Ÿå‹•**ï¼šä½ ä¸éœ€è¦åœ¨è‡ªå·±çš„é›»è…¦ä¸Šå®‰è£ PHP æˆ– Composerï¼Œåªè¦è£å¥½ Dockerï¼ŒæŒ‡ä»¤ä¸€æ‰“å°±é–‹å·¥ï¼
*   ğŸ›¡ï¸ **ç’°å¢ƒä¸€è‡´**ï¼šä¸ç®¡æ˜¯ç”¨ Windowsã€Mac é‚„æ˜¯ Linuxï¼Œå¤§å®¶çš„é–‹ç™¼ç’°å¢ƒéƒ½ä¸€æ¨¡ä¸€æ¨£ï¼Œä¸æœƒå†å‡ºç¾ã€Œå¥‡æ€ªï¼Œåœ¨æˆ‘é›»è…¦ä¸Šæ˜æ˜å¯ä»¥è·‘ã€çš„å•é¡Œã€‚
*   ğŸ› ï¸ **ç°¡å–®æ˜“ç”¨**ï¼šå®ƒæä¾›äº†ä¸€å¥—ç°¡å–®çš„æŒ‡ä»¤ï¼Œè®“ä½ è¼•é¬†ç®¡ç†é€™å€‹é–‹ç™¼ç’°å¢ƒï¼Œä¸ç”¨æˆç‚º Docker å¤§å¸«ä¹Ÿèƒ½ç”¨å¾—å¾ˆé–‹å¿ƒã€‚

**ä¸€å¥è©±ç¸½çµï¼š**
å°±åƒæ˜¯è²·äº†ä¸€çµ„**ã€Œå…¨å¥—å»šæˆ¿æ‡¶äººåŒ…ã€**ï¼Œé‹ç¢—ç“¢ç›†èª¿å‘³æ–™éƒ½æº–å‚™å¥½äº†ï¼Œä½ åªè¦æ‰“é–‹é€™å€‹åŒ…åŒ…ï¼Œå°ˆæ³¨åœ¨ã€Œç…®èœã€ï¼ˆå¯«ç¨‹å¼ï¼‰é€™ä»¶äº‹ä¸Šå°±å¥½å›‰ï¼ğŸ‘¨â€ğŸ³ğŸ‘©â€ğŸ³

## ğŸš€ å¿«é€Ÿé–‹å§‹ (Quick Start)

ç¾åœ¨ï¼Œä½ å·²ç¶“æ“æœ‰äº†ä¸€å€‹å®Œæ•´çš„ Laravel Sail Demoï¼è«‹ä¾ç…§ä»¥ä¸‹ã€Œæ¨™æº–ä½œæ¥­æµç¨‹ã€ä¾†åˆå§‹åŒ–ä¸¦å•Ÿå‹•å°ˆæ¡ˆï¼Œé€™æµç¨‹æ•´åˆäº†æ‰€æœ‰å¸¸è¦‹å•é¡Œçš„ä¿®å¾©ï¼Œä¿è­‰è®“ä½ ä¸€æ¬¡æˆåŠŸï¼âœ¨

### 1. å‰ç½®è¨­å®š (`.env`)
åœ¨å•Ÿå‹• Docker ä¹‹å‰ï¼Œæˆ‘å€‘éœ€è¦å…ˆè¨­å®šä½¿ç”¨è€…æ¬Šé™ï¼Œä»¥å…é‡åˆ° `WWWGROUP variable not set` å°è‡´å•Ÿå‹•å¤±æ•—ã€‚
è«‹æ‰“é–‹å°ˆæ¡ˆæ ¹ç›®éŒ„ä¸‹çš„ `.env` æª”æ¡ˆï¼Œç¢ºèªå·²åŠ å…¥ä»¥ä¸‹è¨­å®šï¼š

```ini
WWWUSER=1000
WWWGROUP=1000
```

### 2. å•Ÿå‹•ç’°å¢ƒ
ç¢ºèªä½ çš„ Docker Desktop å·²ç¶“æ‰“é–‹ï¼Œç„¶å¾Œåœ¨å°ˆæ¡ˆç›®éŒ„åŸ·è¡Œï¼š

```bash
docker compose up -d
```
> ğŸ’¡ ç¬¬ä¸€æ¬¡åŸ·è¡Œæœƒéœ€è¦ä¸‹è¼‰èˆ‡å»ºç½® Docker æ˜ åƒæª”ï¼Œå¯èƒ½éœ€è¦å¹¾åˆ†é˜çš„æ™‚é–“ï¼Œè«‹è€å¿ƒç­‰å€™ã€‚

### 3. åˆå§‹åŒ–å°ˆæ¡ˆ (åˆæ¬¡åŸ·è¡Œå¿…åšï¼)
å®¹å™¨å•Ÿå‹•å¾Œï¼Œæˆ‘å€‘éœ€è¦å° Laravel é€²è¡Œä¸€äº›åˆå§‹åŒ–è¨­å®šï¼Œè«‹**ä¾åº**åŸ·è¡Œä»¥ä¸‹æŒ‡ä»¤ï¼š

*   **æ­¥é©Ÿ 3-1ï¼šç”¢ç”Ÿæ‡‰ç”¨ç¨‹å¼é‡‘é‘° (APP_KEY)**
    ```bash
    ./vendor/bin/sail artisan key:generate
    ```
    > ğŸ’¡ **ç‚ºä»€éº¼è¦åŸ·è¡Œé€™å€‹ï¼Ÿ** æ­¤æŒ‡ä»¤æœƒç”Ÿæˆä¸€çµ„éš¨æ©Ÿå­—ä¸²ä¸¦å¯«å…¥ `.env` çš„ `APP_KEY` ä¸­ï¼Œç”¨æ–¼åŠ å¯†å¯†ç¢¼ã€Session èˆ‡å„é¡æ•æ„Ÿè³‡æ–™ã€‚è‹¥æ²’æœ‰æ­¤é‡‘é‘°ï¼ŒLaravel æœƒç„¡æ³•é‹è¡Œä¸¦é¡¯ç¤ºéŒ¯èª¤ã€‚

*   **æ­¥é©Ÿ 3-2ï¼šåŸ·è¡Œè³‡æ–™åº«é·ç§»**
    ```bash
    ./vendor/bin/sail artisan migrate
    ```

### 4. ç€è¦½ç¶²ç«™
ç•¶ä¸Šè¿°æ­¥é©Ÿéƒ½å®Œæˆå¾Œï¼Œæ‰“é–‹ç€è¦½å™¨è¨ªå•ï¼š

ğŸ‘‰ **[http://localhost](http://localhost)**

ä½ æ‡‰è©²å°±èƒ½çœ‹åˆ° Laravel çš„æ­¡è¿é é¢å›‰ï¼ğŸ‰

---

## âš™ï¸ ç’°å¢ƒè®Šæ•¸è©³ç´°èªªæ˜ (.env)

åœ¨ `.env` æª”æ¡ˆä¸­ï¼Œæœ‰å¹¾å€‹èˆ‡ Laravel Sail é‹ä½œæ¯æ¯ç›¸é—œçš„è®Šæ•¸ï¼Œäº†è§£å®ƒå€‘èƒ½è®“ä½ é–‹ç™¼æ›´é †æ‰‹ï¼š

### ğŸ”‘ APP_KEY
*   **ç”¨é€”**ï¼šLaravel æ‡‰ç”¨çš„å®‰å…¨é‡‘é‘°ã€‚
*   **ç”Ÿæˆæ–¹å¼**ï¼šåŸ·è¡Œ `./vendor/bin/sail artisan key:generate`ã€‚
*   **æ³¨æ„**ï¼šè«‹ç¢ºä¿æ­¤é‡‘é‘°åœ¨ç”Ÿç”¢ç’°å¢ƒä¸­ä¿æŒæ©Ÿå¯†ï¼Œä¸”ä¸è¦éš¨æ„æ›´æ”¹ï¼Œå¦å‰‡å·²åŠ å¯†çš„è³‡æ–™å°‡ç„¡æ³•è§£å¯†ã€‚

### ğŸ³ Sail æ¬Šé™èˆ‡é™¤éŒ¯è¨­å®š
ç‚ºäº†ç¢ºä¿ Docker å®¹å™¨å…§çš„æª”æ¡ˆæ¬Šé™èˆ‡ä½ çš„æœ¬æ©Ÿé›»è…¦ï¼ˆHostï¼‰ä¸€è‡´ï¼Œæˆ‘å€‘ä½¿ç”¨ä»¥ä¸‹è®Šæ•¸ï¼š

*   **`WWWUSER` & `WWWGROUP`**
    *   **ç”¨é€”**ï¼šæŒ‡å®šå®¹å™¨å…§é‹ä½œ PHP/Nginx ç¨‹åºçš„ User ID èˆ‡ Group IDã€‚
    *   **è¨­å®šå»ºè­°**ï¼šé€šå¸¸è¨­å®šç‚º `1000`ã€‚åœ¨ Linux/Mac ä¸Šï¼Œè¨­å®šç‚ºèˆ‡ä½ æœ¬æ©Ÿä½¿ç”¨è€…ç›¸åŒçš„ IDï¼ˆå¯ç”¨ `id -u` æŸ¥è©¢ï¼‰ï¼Œå¯ä»¥é¿å…åœ¨ä¿®æ”¹ç¨‹å¼ç¢¼æˆ–é€é Sail ç”¢ç”Ÿæª”æ¡ˆå¾Œç™¼ç”Ÿã€Œæ¬Šé™ä¸è¶³ (Permission Denied)ã€çš„å›°æ“¾ã€‚
*   **`SAIL_XDEBUG_MODE`**
    *   **ç”¨é€”**ï¼šè¨­å®š PHP Xdebug çš„æ¨¡å¼ã€‚
    *   **å¸¸ç”¨å€¼**ï¼š
        *   `off`ï¼šé—œé–‰ Xdebugï¼ˆé è¨­ï¼Œé€Ÿåº¦è¼ƒå¿«ï¼‰ã€‚
        *   `debug`ï¼šé–‹å•Ÿæ­¥é€²é™¤éŒ¯ï¼ˆBreakpoint debuggingï¼‰ã€‚
        *   `develop`ï¼šé–‹å•Ÿé–‹ç™¼è¼”åŠ©å·¥å…·ï¼ˆåƒæ˜¯æ›´è©³ç´°çš„éŒ¯èª¤å›æº¯ï¼‰ã€‚
*   **`SAIL_XDEBUG_CONFIG`**
    *   **ç”¨é€”**ï¼šå‚³éé¡å¤–çš„ Xdebug åƒæ•¸ã€‚
    *   **é è¨­å€¼**ï¼š`"client_host=host.docker.internal"`ï¼Œé€™èƒ½å¼•å° Xdebug æ­£ç¢ºé€£æ¥å›ä½ çš„ IDEï¼ˆå¦‚ VS Code æˆ– PHPStormï¼‰ã€‚
*   **ç¢ºèª Xdebug ç‹€æ…‹**
    *   ç€è¦½å™¨è¨ªå•ï¼š`http://localhost/xdebug`
    *   æª¢æŸ¥é‡é»ï¼šæœå°‹ "Step Debugger"ï¼Œç¢ºèªå…¶ç‹€æ…‹ç‚º **âœ” enabled**ã€‚

### ğŸ Xdebug æ•…éšœæ’é™¤ SOP (Troubleshooting)
å¦‚æœè¨­å®šäº†ä¸­æ–·é»ï¼ˆBreakpointï¼‰å»ç„¡æ³•åœä½ï¼Œè«‹ä¾åºåŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿæª¢æŸ¥ï¼š

1.  **ç¢ºèª Xdebug æ˜¯å¦å·²æ­£ç¢ºé€£ç·šï¼ˆStep Debuggerï¼‰**
    *   ç€è¦½ [http://localhost/xdebug](http://localhost/xdebug)
    *   æœå°‹ **Step Debugger**ï¼Œç‹€æ…‹å¿…é ˆç‚º **âœ” enabled**ã€‚
    *   è‹¥æœªå•Ÿç”¨ï¼Œè«‹æª¢æŸ¥ `.env` ä¸­çš„ `SAIL_XDEBUG_MODE` æ˜¯å¦åŒ…å« `debug`ã€‚

2.  **ç¢ºèª VS Code æ˜¯å¦æ­£åœ¨ç›£è½**
    *   å·¦å´ã€ŒåŸ·è¡Œèˆ‡åµéŒ¯ (Run and Debug)ã€é¢æ¿æ˜¯å¦å·²å•Ÿå‹•ï¼Ÿï¼ˆç‹€æ…‹åˆ—æ‡‰å‘ˆç¾æ©˜è‰²ï¼‰ã€‚
    *   æ˜¯å¦é¸æ“‡ **"Listen for Xdebug (Legacy)"**ï¼Ÿ

3.  **æª¢æŸ¥ Xdebug é€£ç·šæ—¥èªŒ**
    *   è‹¥ä¸Šè¿°éƒ½æ­£å¸¸ä½†ä»ç„¡åæ‡‰ï¼Œè«‹æŸ¥çœ‹å®¹å™¨å…§çš„ Xdebug éŒ¯èª¤æ—¥èªŒï¼š
        ```bash
        ./vendor/bin/sail exec laravel.test cat /tmp/xdebug.log
        ```
    *   **å¸¸è¦‹éŒ¯èª¤**ï¼š
        *   `Trigger value for 'XDEBUG_SESSION' not found`ï¼šè¡¨ç¤º Xdebug ä¸çŸ¥é“ç¾åœ¨éœ€è¦é™¤éŒ¯ã€‚
            *   **è§£æ³•**ï¼šåœ¨ `compose.yaml` çš„ `environment` å€å¡Šå¼·åˆ¶åŠ å…¥ `XDEBUG_SESSION: 1`ã€‚
        *   `Time-out connecting to client`ï¼šè¡¨ç¤ºå®¹å™¨ç„¡æ³•é€£ç·šåˆ°ä¸»æ©Ÿã€‚
            *   **è§£æ³•**ï¼šç¢ºèª `SAIL_XDEBUG_CONFIG` åŒ…å« `client_host=host.docker.internal`ã€‚
            *   **è§£æ³•**ï¼šç¢ºèª `launch.json` ä¸­çš„ `hostname` è¨­ç‚º `0.0.0.0`ï¼ˆå…è¨±ä¾†è‡ªå¤–éƒ¨çš„é€£ç·šï¼‰ã€‚

4.  **å¼·åˆ¶é‡å•Ÿ**
    *   ä¿®æ”¹é…ç½®å¾Œï¼Œå‹™å¿…åŸ·è¡Œ `down` èˆ‡ `up` è®“è¨­å®šç”Ÿæ•ˆï¼š
        ```bash
        ./vendor/bin/sail down && ./vendor/bin/sail up -d
        ```

---

### ğŸ› ï¸ å·¥ä½œæŒ‡ä»¤å½™æ•´
ä¾ç…§å°ˆæ¡ˆè¦ç¯„ï¼Œè«‹çµ±ä¸€ä½¿ç”¨ `./vendor/bin/sail` å‰ç¶´ã€‚

*   **å•Ÿå‹•æœå‹™**ï¼š`./vendor/bin/sail up -d`
*   **åœæ­¢æœå‹™**ï¼š`./vendor/bin/sail down`
*   **åŸ·è¡Œ Artisan æŒ‡ä»¤**ï¼š`./vendor/bin/sail artisan ...`
*   **åŸ·è¡Œ Composer æŒ‡ä»¤**ï¼š`./vendor/bin/sail composer ...`
*   **åŸ·è¡Œ Node/NPM æŒ‡ä»¤**ï¼š`./vendor/bin/sail npm ...`

---

## ğŸ“š é€²éšæŒ‡å— & æ–‡ä»¶

- **[Spatie Laravel Permission å®‰è£èˆ‡è¨­å®š](./docs/laravel-permission-installation.md)**
  - è©³ç´°èªªæ˜å¦‚ä½•åœ¨ Laravel Sail ç’°å¢ƒä¸‹æ­£ç¢ºå®‰è£ä¸¦è¨­å®š `spatie/laravel-permission` æ¬Šé™ç®¡ç†å¥—ä»¶ã€‚
  - åŒ…å«å¸¸è¦‹éŒ¯èª¤æ’é™¤ï¼ˆå¦‚æœªå•Ÿå‹•å®¹å™¨å³åŸ·è¡ŒæŒ‡ä»¤ï¼‰ã€‚
  - **[NEW]** æ–°å¢ã€Œç€è¦½å™¨å¯¦æ¸¬æµç¨‹ã€ï¼Œæ•™æ‚¨å¦‚ä½•é€éä½¿ç”¨è€…è¨»å†Šèˆ‡ Tinker æŒ‡ä»¤ï¼Œç›´æ¥åœ¨ç¶²é ä¸Šé©—è­‰æ¬Šé™åŠŸèƒ½ã€‚
  - **[NEW]** æ–°å¢ã€Œè³‡æ–™åº«é©—è­‰æŒ‡å—ã€ï¼Œèªªæ˜å¦‚ä½•ä½¿ç”¨ phpMyAdmin æŸ¥çœ‹æ¬Šé™é—œè¯è¡¨ã€‚

- **[Inertia Page Props é…ç½®æŒ‡å—](./docs/inertia-page-props.md)**
  - èªªæ˜å¦‚ä½•åœ¨ Laravel Inertia å°ˆæ¡ˆä¸­è¨­å®šå…¨åŸŸå…±äº«è³‡æ–™ (Shared Data)ã€‚
  - åŒ…å« Middleware é…ç½®ç¯„ä¾‹èˆ‡ Vue å‰ç«¯èª¿ç”¨æ–¹å¼ã€‚

- **[å¤šèªç³» (i18n) è¨­å®šèªªæ˜](./docs/i18n-setup.md)**
  - èªªæ˜å¦‚ä½•æ•´åˆ Laravel èˆ‡ Vue i18nï¼Œå¯¦ç¾å‰å¾Œç«¯å–®ä¸€èªç³»æª” (Single Source of Truth)ã€‚

- **[å‰å¾Œç«¯èªç³»å…±äº«èˆ‡å®‰å…¨ä¿è­·æ©Ÿåˆ¶ (i18n Security)](./docs/i18n-security-guide.md)**
  - è©³è¿°å¦‚ä½•å»ºç«‹å…·å‚™è‡ªå‹•åŒ–åŠ å¯† (LZ-String) èˆ‡å£“ç¸®åŠŸèƒ½çš„èªç³»ç³»çµ±ã€‚
  - åŒ…å« Vite æ’ä»¶å¯¦ä½œï¼Œæ—¨åœ¨ä¿è­·èªç³»æª”æ¡ˆå…æ–¼å¤§è¦æ¨¡æŠ“å– (Dumping)ã€‚

- **[Session èˆ‡ Redis å„²å­˜èªªæ˜](./docs/laravel_session.md)**
  - è¨˜éŒ„å°ˆæ¡ˆä¸­ Session çš„å„²å­˜æ©Ÿåˆ¶ã€åºåˆ—åŒ–æ ¼å¼ (PHP Serialization) ä»¥åŠå®‰å…¨æ€§é…ç½®ã€‚
  - æä¾›å¤šç¨®æŸ¥çœ‹ Session è³‡æ–™çš„æ–¹æ³•ï¼ŒåŒ…å« Redis CLIã€Tinker ä»¥åŠ Redis Insight åœ–å½¢åŒ–ä»‹é¢ã€‚

- **[Laravel Testing æŒ‡å— (å« Coverage)](./docs/laravel-testing.md)**
  - èªªæ˜å¦‚ä½•åœ¨ Laravel Sail ç’°å¢ƒä¸­åŸ·è¡Œæ¸¬è©¦ã€‚
  - åŒ…å«å¦‚ä½•é€é Xdebug æˆ– PCOV ç”¢ç”Ÿ HTML æ ¼å¼çš„ç¨‹å¼ç¢¼è¦†è“‹ç‡ (Code Coverage) å ±å‘Šã€‚
  - [coverage](./coverage)

  